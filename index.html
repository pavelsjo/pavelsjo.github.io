<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pavelsjo</title>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
    <script src="https://kit.fontawesome.com/c4d3502012.js" crossorigin="c4d3502012"></script>
    <link href="styles/style.css" rel="stylesheet" type="text/css">
</head>
<body>
    <header>
        <div id="data-science" class="tabcontent">
            <h1>Data Science</h1>
            <p>Extract insights from data.</p>
          </div>
          
          <div id="machine-learning" class="tabcontent">
            <h1>Machine Learning</h1>
            <p>Automatize workflows with ML models.</p>
          </div>
          
          <div id="data-apps" class="tabcontent">
            <h1>Data Applications</h1>
            <p>Use insights and ML models to build aplications.</p>
          </div>
          
          <div id="tensor-flow" class="tabcontent">
            <h1>TensorFlow js</h1>
            <p>TensorFlow js is an end-to-end open-source platform for machine learning in web browser.</p>
          </div>
          
          <button class="tablink" onclick="openCategory('data-science', this, '#336699')" id="defaultOpen">Data Science</button>
          <button class="tablink" onclick="openCategory('machine-learning', this, '#FF6F00')">Machine Learning</button>
          <button class="tablink" onclick="openCategory('data-apps', this, '#425066')">Data Apps</button>
          <button class="tablink" onclick="openCategory('tensor-flow', this, 'black')">TensorFlow js</button> 
    </header>
    <div class='resume-box'>
        <img src="blog/01-keep-last-date-oac-df/images/step-00.png" alt='bar post' class="img-resume-box">
        <div>
            <h2 class="header-resume-box"> <a href="blog/01-keep-last-date-oac-df.htm">Keep Last Date OAC Data Flow</a></p></h2>
            <p class="description-resume-box">Kown how to deal with duplicate data keeping only <strong>last row by date</strong>.</p>
        </div>
        <div class='icon-resume-box'>
            <a href="blog/01-keep-last-date-oac-df/data/01-initial-state.csv"><i class="fas fa-file-csv"></i></i></a> 
            <a href="blog/01-keep-last-date-oac-df/data/02-desired-state.csv"><i class="fas fa-file-csv"></i></i></a>
            <a href="blog/01-keep-last-date-oac-df/files/keep-last-date-oac-df.dva"><i class="fas fa-chart-bar"></i></a> 
        </div>
    </div>
    <div class="detail-box">
        <div class="row">
            <div class="column" style="background-color:#aaa;">
                <h2>Initial State</h2>
                <table>
                    <tr>
                        <th>ID</th>
                        <th>Place</th>
                        <th>Date</th>
                        <th>Value</th>
                    </tr>
                    <tr>
                        <td>0</td>
                        <td>Temuco</td>
                        <td>10/10/2020</td>
                        <td>3</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Temuco</td>
                        <td>10/11/2020</td>
                        <td>2</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Temuco</td>
                        <td>10/12/2020</td>
                        <td>7</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Maldiva</td>
                        <td>10/09/2020</td>
                        <td>2</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Sucenaga</td>
                        <td>10/09/2020</td>
                        <td>12</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Cairo</td>
                        <td>10/09/2020</td>
                        <td>26</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Maldiva</td>
                        <td>10/10/2020</td>
                        <td>6</td>
                    </tr>
                </table>
            </div>
            <div class="column" style="background-color:#bbb;">
                <h2>Desired State</h2>
                <table>
                    <tr>
                        <th>ID</th>
                        <th>Place</th>
                        <th>Date</th>
                        <th>Value</th>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Temuco</td>
                        <td>12/10/2020</td>
                        <td>7</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Sucenaga</td>
                        <td>09/10/2020</td>
                        <td>12</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Cairo</td>
                        <td>09/10/2020</td>
                        <td>26</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Maldiva</td>
                        <td>10/10/2020</td>
                        <td>6</td>
                    </tr>                    
                </table>
            </div>
        </div>
       <h4>0. Load data frame with initial state</h4>
       <img src="blog/01-keep-last-date-oac-df/images/step-00.png">
       <h4>2. Search for max date by place</h4>
       <p>MAX(Date by Place)</p>
       <img src="blog/01-keep-last-date-oac-df/images/step-01.png">
       <h4>3. Create a Boolean to track last date</h4>  
       <p>  CASE WHEN Date = LastDate THEN 1 ELSE 0 END</p>
       <img src="blog/01-keep-last-date-oac-df/images/step-02.png">
       <h4>4. Apply Boolean filter to keep last equal 1</h4>
       <img src="blog/01-keep-last-date-oac-df/images/step-03.png">
       <h4>4. Remove transition columns</h4>
       <img src="blog/01-keep-last-date-oac-df/images/step-04.png">
       <h4>5. Save desired state</h4>
       <img src="blog/01-keep-last-date-oac-df/images/step-05.png">
</div>
<script src="scripts/main.js"></script>
</body>
</html>